<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chat AI – ESG Laporan</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Mengatur scrollbar agar tidak terlihat */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  </style>
</head>
<body class="bg-slate-100 text-slate-900 font-sans">

  <main class="max-w-6xl mx-auto px-4 py-8 md:px-6 md:py-10">

    <!-- Header -->
    <header class="mb-6 text-center">
      <h1 class="text-3xl md:text-4xl font-bold text-teal-700">Chat AI – Laporan ESG</h1>
      <p class="text-slate-500 mt-1">Economic, Environmental, Social, and Governance – Chat Support</p>
    </header>

<form action="/umkm/chatAI" method="POST">
<!-- Chat Interface Section -->
    <section class="w-full bg-white rounded-2xl shadow-2xl">
      <div class="flex flex-col h-[600px] md:h-[700px]">
        <!-- Chat Header -->
        <header class="px-6 py-3 bg-teal-500 text-white rounded-t-2xl">
          <div class="flex justify-between items-center">
            <h2 class="text-xl font-semibold">Layanan Chat AI</h2>
          </div>
        </header>

        <!-- Chat Messages Area -->
        <div id="chat-messages" class="overflow-y-auto p-4 space-y-4 flex-grow no-scrollbar">
          <!-- Pesan awal dari AI -->
          <div class="flex items-start animate-fade-in">
            <div class="bg-teal-100 text-teal-900 rounded-lg p-3 md:p-4 max-w-xs md:max-w-sm">
              <p class="text-sm">Halo! Ada yang bisa saya bantu dengan laporan ESG?</p>
            </div>
          </div>
        </div>

        <!-- Message Input Area -->
        <div class="flex gap-3 items-center px-4 py-3 md:px-6 md:py-4 bg-gray-100 rounded-b-2xl">
            <input type="text" id="questionInput" placeholder="Tulis pertanyaan Anda..." class="w-full border p-2 rounded" />
        <button onclick="askDynamicAI()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm">Kirim</button>
            <!-- Ikon Panah ke Kanan -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="w-5 h-5 md:w-6 md:h-6">
                <path d="M10 17l5-5-5-5v10z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" fill="white"/>
            </svg>
          </button>
        </div>
        <div id="aiResponse" class="mt-4 text-sm text-gray-700 bg-gray-100 p-3 rounded hidden"></div>
      </div>
    </section>
</form>

    
  </main>
<script>
  async function askAI(question) {
  const response = await fetch("/ask-ai", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ prompt: question }),
  });

  const data = await response.json();
  const box = document.getElementById("aiResponse");
  box.innerText = data.response;
  box.classList.remove("hidden");
}

async function askDynamicAI() {
  const question = document.getElementById("questionInput").value.trim();
  if (question === "") {
    alert("Pertanyaan tidak boleh kosong.");
    return;
  }

  // Tampilkan loading
  const aiBox = document.getElementById("aiResponse");
  aiBox.innerText = "Sedang memproses...";
  aiBox.classList.remove("hidden");

  // Kirim ke server
  const response = await fetch("/ask-ai", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ prompt: question }),
  });

  const data = await response.json();
  aiBox.innerText = data.response;
}

</script>
